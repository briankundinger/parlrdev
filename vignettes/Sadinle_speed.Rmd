---
title: "Sadinle_speed"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Sadinle_speed}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
devtools::load_all()
library(parlrdev)
```


```{r}
show_progress <- T
n1 <- 5000; n2 <- 5000
overlap <- n2/2


m <- c(.05, .95, .05, .95, .05, .95, .05, .95, .05, .95)

u <- c(.99, .01, .99, .01, 
        1 - 1/30, 1/30, 1 - 1/12, 1/12, 1 - 1/15, 1/15)


levels <- c(2, 2, 2, 2, 2)

iter <- 1
S <- 100; burn <- S * .1
m_prior <- u_prior <- rep(1, length(m))
alpha <- beta <- 1
EVAL.SAMPS6 <- array(NA, dim = c(iter, 3, 2))

for(i in 1:iter){
comparisons <- SimulateComparisons(m, u, levels, n1, n2,overlap)
Ztrue <- comparisons[[5]]

Zchain <- Sadinle17(comparisons, m_prior, u_prior, 
                    alpha, beta, S, burn, show_progress = F)
Zhat <- BRL::linkRecords(Zchain, n1, 1, 1, 2, Inf)
eval <- GetEvaluations(Zhat, Ztrue, n1)
EVAL.SAMPS6[i, ,1] <- eval

Zchain <- BKSimple2(comparisons, m_prior, u_prior, 
                   alpha, beta, S, burn, show_progress = T)
Zhat <- BRL::linkRecords(Zchain, n1, 1, 1, 2, Inf)
eval <- GetEvaluations(Zhat, Ztrue, n1)
EVAL.SAMPS6[i, ,2] <- eval
#print(i)
}
EVAL.SAMPS6

Zchain <- BKSimple_hash(comparisons, m_prior, u_prior, 
                   alpha, beta, S, burn, show_progress = T, fast = F)
Zhat <- BRL::linkRecords(Zchain, n1, 1, 1, 2, Inf)
eval <- GetEvaluations(Zhat, Ztrue, n1)
eval
```


```{r cache=TRUE}
knitr::opts_current$get(c(
  "cache",
  "cache.path",
  "cache.rebuild",
  "dependson",
  "autodep"
))
```

